## –ß–∞—Ç–±–æ—Ç —Å –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–º –ø–æ–∏—Å–∫–æ–º –Ω–∞ Colpali –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç–≤–µ—Ç–æ–≤ —Å–ø–æ–º–æ—â—å—é LLaMA 3.2 Vision 11b

–ö–æ–º–∞–Ω–¥–∞: 200 OK

–¢—Ä–µ–∫: –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ RAG –º–æ–¥–µ–ª–∏

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç —Ö–∞–∫–∞—Ç–æ–Ω–∞
–ö–æ–º–∞–Ω–¥–∞ –∑–∞–Ω—è–ª–∞ 3-–µ –º–µ—Å—Ç–æ </br >
![](https://github.com/200-OK-Colpali/chat_front/blob/main/results.jpg)

---

## –ö–æ–º–∞–Ω–¥–∞

[–°–∏–±—Ä–∏–∫–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä](https://t.me/sibrikov) - –ö–∞–ø–∏—Ç–∞–Ω </br >
[–ú–∞–ª—ã—à –ò–≥–æ—Ä—å](https://t.me/igmalysh) - Fullstack </br >
[–ì—É—Å–∞—Ä–æ–≤ –ê–ª–µ–∫—Å–µ–π](https://t.me/korolaab) - ML Captain </br >
[–®–∫–∏—Ä–æ–≤ –í–∏–∫—Ç–æ—Ä](https://t.me/mc_pendulum) - Backend </br >
[–®–∞—Ä–∞—Ñ—É—Ç–¥–∏–Ω–æ–≤ –ê—Ä—Ç—É—Ä](https://t.me/ArchiBut) - ML </br >
---

[–ù–∞ –≤—Ä–µ–º—è —Ö–∞–∫–∞—Ç–æ–Ω–∞] –†–µ—à–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –∑–¥–µ—Å—å:
</br >
http://95.31.161.233:8080/

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –Ω–µ–ø–æ–ª–∞–¥–æ–∫, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ —Ç–µ–ª–µ–≥—Ä–∞–º: </br >
</br >
https://t.me/sibrikov </br >
https://t.me/igmalysh </br >
https://t.me/korolaab </br >
https://t.me/mc_pendulum </br >
https://t.me/ArchiBut </br >

---

## –û–±–∑–æ—Ä  

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ —Ä–∞–±–æ—Ç—ã —Å –º–Ω–æ–≥–æ–º–æ–¥–µ–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π Retrieval-Augmented Generation (RAG). –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç PDF-—Ñ–∞–π–ª, –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –ø–æ–º–æ—â—å—é Colpali –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É RAG. –ü—Ä–æ—Ü–µ—Å—Å –≤–∫–ª—é—á–∞–µ—Ç –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –¥–æ–∫—É–º–µ–Ω—Ç–∞, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ Llama –≤–µ—Ä—Å–∏–∏ 3.2.  

## –ú–æ—Ç–∏–≤–∞—Ü–∏—è  

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –æ–±–µ—Å–ø–µ—á–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (PDF, DOCX, PPTX, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —Ç–µ–∫—Å—Ç –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ.  

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞  

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: –∫–∞–∫ —Ç–µ–∫—Å—Ç–∞, —Ç–∞–∫ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.  
- –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.  
- –ì–∏–±–∫–æ—Å—Ç—å –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–µ—Ä–µ–¥–æ–≤—ã—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (Llama).  

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è  

1. PDF-—Ñ–∞–π–ª –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è, –ø–æ—Å–ª–µ —á–µ–≥–æ –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∏ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Å–µ–≥–º–µ–Ω—Ç—ã.  
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –∫ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –¥–æ–∫—É–º–µ–Ω—Ç—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.  
3. –ò–∑–≤–ª–µ—á—ë–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –º–æ–¥–µ–ª—å Llama –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞.  

## –ò—Ç–æ–≥  

–ü—Ä–æ–µ–∫—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –ø–æ–∏—Å–∫ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã.

## –ü–∞–π–ø–ª–∞–π–Ω

![Static Image](http://d.zaix.ru/Km79.png)

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

![GIF Demo](https://github.com/200-OK-Colpali/chat_front/blob/main/Colpali-RAG-demo-ezgif.com-speed.gif)

---

## –û–ø–∏—Å–∞–Ω–∏–µ

–ß–∞—Ç–±–æ—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –∏ –æ—Ç–≤–µ—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞. –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ Docker –∏ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–≤—É—Ö –º–∞—à–∏–Ω —Å GPU.

## –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

1. **–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏–Ω–¥–µ–∫—Å –∏—Å–ø–æ–ª—å–∑—É—è bash —Å–∫—Ä–∏–ø—Ç:**
   ```
   bash load_files.bash
   ```
---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ–∫—Ä—É–∂–µ–Ω–∏—é
–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ —Å–ª–µ–¥—É–µ—à–∏—Ö –≤–µ—Ä—Å–∏—è—Ö —è–¥—Ä–∞, –ü–û, –¥—Ä–∞–π–≤–µ—Ä–æ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ hardware

### –í–µ—Ä—Å–∏–∏ —è–¥—Ä–∞, –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫
```
Docker version 24.0.7, build afdd53b
NVIDIA Container Runtime Hook version 1.17.2
NVIDIA Driver Version: 535.113.01
CUDA Version: 12.2
Linux COMP 6.2.0-33-generic #33~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Thu Sep  7 10:33:52 UTC 2 x86_64 x86_64 x86_64 GNU/Linux
```

### –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
```
CPU: Ryzen 1700
RAM: 16GB
GPU: RTX2070 8GB (–º–∞—à–∏–Ω–∞ 1 –¥–ª—è Colpali)
GPU: RTX4090 24GB (–º–∞—à–∏–Ω–∞ 2 –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ LLaMA 3.2)
```

---
# –†–µ—à–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–ª–æ—Å—å –Ω–∞ 2—Ö –º–∞—à–∏–Ω–∞—Ö —Å gpu, —Ç–∞–∫ –∫–∞–∫ –Ω–µ —Ö–≤–∞—Ç–∞–ª–æ GPU memory.

## –®–∞–≥–∏ –∑–∞–ø—É—Å–∫–∞

### 0. –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

–í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ `pipelines.py`:
```python
# –í —Ñ—É–Ω–∫—Ü–∏–∏ generate_oollama_response_generator —É–∫–∞–∑–∞—Ç—å –∞–¥—Ä–µ—Å 2-–π –º–∞—à–∏–Ω—ã –∏ 3000 –ø–æ—Ä—Ç
url = "http://[—É–∫–∞–∑–∞—Ç—å —Ç—É—Ç –∞–¥—Ä–µ—Å 2 –º–∞—à–∏–Ω—ã]:3000/api/chat"
```


‚ùóÔ∏è‚ùóÔ∏è‚ùóÔ∏è 
–ü–æ-—É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–Ω–¥–µ–∫—Å, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω –±–∞–∑–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç, –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π –¥–∞—Ç–∞—Å–µ—Ç —Å –Ω—É–ª—è
### [–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ] 0. –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞

1. –ü—Ä–∏–¥—É–º–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞
2. –í —Ñ–∞–π–ª–µ create_new_index.py –ø–æ–º–µ–Ω—è—Ç—å –≤ —Å—Ç—Ä–æ—á–∫–µ index_name="test_index_name" –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ —Å test_index_name –Ω–∞ —Å–≤–æ–µ
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å create_new_index.py
4. –í —Ñ–∞–π–ª–µ pipeline.py –Ω–∞–π—Ç–∏ —Å—Ç—Ä–æ—á–∫—É index_path="./global_index" –∏ –ø–æ–º–µ–Ω—è—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ —Å global_index –Ω–∞ —Å–≤–æ–µ
5. –ì–æ—Ç–æ–≤–æ

### 1. –ó–∞–ø—É—Å–∫ –Ω–∞ –º–∞—à–∏–Ω–µ 2
```bash
docker run -it --gpus=all -p 3000:11434 --name ollama ollama/ollama:latest
```

### 2. –ó–∞–ø—É—Å–∫ –Ω–∞ –º–∞—à–∏–Ω–µ 1
```bash
docker build -t=ragsol .
```

```bash
docker run -it --gpus=all -p 8080:8080 --name=ragsol -v=./docs:/app/docs -v ./test_dataset:/app/test_dataset -v=./.byaldi:/app/.byaldi -v ./colpali:/app/colpali ragsol
```

```bash
docker exec -it ragsol bash
```

```bash
streamlit run main.py --server.port=8080  # <- –∑–∞–ø—É—Å–∫ —Ñ—Ä–æ–Ω—Ç–∞ –Ω–∞ 8080 –ø–æ—Ä—Ç—É –Ω–∞ –ª–æ–∫–∞–ª —Ö–æ—Å—Ç–µ
```
‚ùóÔ∏è‚ùóÔ∏è‚ùóÔ∏è^ –Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–∏–∑–∞–π–¥–µ—Ç –∑–∞–≥—Ä—É—Å–∫–∞ colpali –º–æ–¥–µ–ª–∏ ~ 6–ì–±
‚åõÔ∏è –ù—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å...

üòé **FINAL** –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä –Ω–∞ http://[–∞–¥—Ä–µ—Å –º–∞—à–∏–Ω—ã 1]:8080

